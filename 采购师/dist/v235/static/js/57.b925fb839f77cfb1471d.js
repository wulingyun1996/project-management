webpackJsonp([57,227,229],{JjoA:function(t,o){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAoCAYAAACWwljjAAAAAXNSR0IArs4c6QAAAilJREFUWAntmD0vBFEUhmcEISI0iE6yEgkKlb8gIhFBJ1SIH6Cg2tZHo6CSqFREIxHN0tAoJUh0GvEVCVtQ2FjP2Z3Z3N29d3fGZGeaOcm758yZe+a8991772TXymazKRCGpWkyZ1UxW5gw5he8KmObiNvBF0greS9hK4NawCf4Vgo6iKXXqG3bKSVfHDrSPKpZchNOflvNe4mpW3dqZ9Tx5Bac/Ae+X72nxnXqRS1jVNnl+RugDZxAqkvXLzRCTvMV/BHoAceQasYXWaiEUEnW0Cy4AsNgH1I2vmChEpKukJKFPg4ewCSQr7FgoROSzpCSHT0GZCcuo9IiPmeREJLOkLrDTYEfsAOpEbwVGSFpDqkz3BKoBweQGpSgkiUYJLPwY31+BkNqjx691KyCQ4sLsdKDcTSfDvQ57ZUYXeSN8SLdTAqd87Ak6PT60JJx71yfluSMl6gkXDK5ARJhRQoZK2t4QzgIEZNCLllZD43/5PHGzJ991worrEwhckm5EcAy1Hpe4IytqtAFs7sEDb5nmS8QdZ581zoKlCnk+0EBC1yFIj0YdXOICelUUXOxQqoauth4MLLqExTMgyDbfovDMf9K0HXX5Uzbnvymcy+IG9L11OVoUvVgXKPwHgRR6FrXvGLOmX58MJpUire9SRk3HyvkKmHysUImZdx8rJCrhMm7L9cOTmz5iyRKk7/8LPmFdoMfiJKJ0vtWCMnLs1tJRhn6/5VSa7Z/U7ouTfmOjy4AAAAASUVORK5CYII="},XhL9:function(t,o){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACYAAAAkCAYAAADl9UilAAAAAXNSR0IArs4c6QAAAjBJREFUWAntmD0sA1EcwO8UITFU6MLCZrMxGLqQECERK4mN2HzMEomNGZtUwiQxsUjawVAsNmIgkkpEJIZKSEVbv//lTq6un3evV0P/yc+7vo//+/W99l2PrvkY2Wx2g+lWypgy3VhGJ5VdEiS7KpAwQP2Q2ZbReRdbvJBKJaHr+lKliXBoYEwEZsyxGY3KFCiLSqWkP5PvmgJRynP43cpL2uekk9+BhOzYPFzAJByDYSsrFjVe+PyHeddB4hqCps8Z12lrK30XY/JVkLiBkLUmXNdOjMkXQOIeuiypmq4YIrOQgQT02KXsYvI19S0QmWayPXiFYY6WR8q84dsBi9QYBoeQhBGk7vIaadoB9XFfPvxIheEDkjBQQCi3mo5VPS7IPwjvIGLh3NmLvKJz1cTI3Q9v5hyjRTScTdUSI28fvMA3TDlnLlHDIOUrRs5eeII0WDfmEiZ/mhmoVIx83fAAEnIPdBcMViZGrhDcgsSyOyNzFAmUiJEnCHIzllhzK8XYNmhXco6ZyeKUEptupWQc49XcxEnUAjGQ2PEipUwMkSY4ESNiH/SaiyERgCOQkFLJcwN53G8lg+UhJgISp9DsdaWs8eTyJLYtRkQMWq2kKkryGWJuf489IyEPMBP8fPlUIeTIgaGrc4xxyrbPLuV1xTRW6sueUPW1261U7eHIVxdzLEmJivqKlVggR7P1+NbB13Tc0Vqbik6ZVm4tKcqqnEke3pfxj7tFEvy3z1r2B0jMk2xH8QM9AAAAAElFTkSuQmCC"},oC2W:function(t,o){},ut8x:function(t,o,e){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var i=e("mvHQ"),s=e.n(i),a=e("bdOr"),n=e("Uwql"),c=e("qIUM"),r=e("bh5B"),u=e("DHfu"),l=e("X2Oc"),h=e("TfiU"),d=(h.mixins,l.p,a.default,n.default,c.default,r.a,{data:function(){return{quotation:[],isManage:!0,hasSelect:!1,name:"",isCheckAll:!1,id:"",buyer_id:"",showConfirm:!1,isFirstEnter:!1,firstGuidePage:!0,twoGuidePage:!1,isShowSharePopup:!1,limitMoreClick:!0,mobile:"",nickName:"",person:""}},computed:{isFromGoodsDetail:function(){return!!this.$route.query.fromGoodsDetail},quotationLength:function(){return!!this.quotation.length},isSelect:function(){return Object(h.isSelectArr)(this.quotation)},total:function(){var t=this,o=0,e=0,i=0,s=0,a=0;return this.quotation.length>0&&this.quotation.map(function(n){n.goodsInfo.map(function(n){a+=1,n.kinds.map(function(a){if(t.hasSelect){if(a.checked){if(1===n.goods_type)o=Object(h.solove)(o,Object(h.solove)(a.count,a.price,"*"),"+"),s+=0;else if(0===n.price_type)o=Object(h.solove)(o,Object(h.solove)(a.count,a.promotion_price,"*"),"+"),s=a.svip_price?Object(h.solove)(s,Object(h.solove)(a.count,Object(h.formatCommission)(Object(h.solove)(Object(h.solove)(a.promotion_price,a.purchase_price,"-"),Object(h.solove)(1,a.one_discount,"+"),"*")),"*"),"+"):Object(h.solove)(s,Object(h.solove)(a.count,Object(h.solove)(a.promotion_price,a.purchase_price,"-"),"*"),"+");else{var c=Object(h.totalNum)(n.kinds,t.hasSelect),r=Object(h.resultPrice)(c,n.intervalPrice,a,t.hasSelect,a.checked);if(o=Object(h.solove)(o,Object(h.solove)(a.count,r.promotion_price,"*"),"+"),a.svip_price){var u=Object(h.formatCommission)(Object(h.solove)(Object(h.solove)(r.promotion_price,r.purchase_price,"-"),Object(h.solove)(1,a.one_discount,"+"),"*"));s=Object(h.solove)(s,Object(h.solove)(a.count,u,"*"),"+")}else s=Object(h.solove)(s,Object(h.solove)(a.count,Object(h.solove)(r.promotion_price,r.purchase_price,"-"),"*"),"+")}i++,e+=Number(a.count)}}else{if(1===n.goods_type)o=Object(h.solove)(o,Object(h.solove)(a.count,a.price,"*"),"+"),s+=0;else if(0===n.price_type)o=Object(h.solove)(o,Object(h.solove)(a.count,a.promotion_price,"*"),"+"),s=a.svip_price?Object(h.solove)(s,Object(h.solove)(a.count,Object(h.formatCommission)(Object(h.solove)(Object(h.solove)(a.promotion_price,a.purchase_price,"-"),Object(h.solove)(1,a.one_discount,"+"),"*")),"*"),"+"):Object(h.solove)(s,Object(h.solove)(a.count,Object(h.solove)(a.promotion_price,a.purchase_price,"-"),"*"),"+");else{var l=Object(h.totalNum)(n.kinds,t.hasSelect),d=Object(h.resultPrice)(l,n.intervalPrice,a,t.hasSelect,!1);if(o=Object(h.solove)(o,Object(h.solove)(a.count,d.promotion_price,"*"),"+"),a.svip_price){var m=Object(h.formatCommission)(Object(h.solove)(Object(h.solove)(d.promotion_price,d.purchase_price,"-"),Object(h.solove)(1,a.one_discount,"+"),"*"));s=Object(h.solove)(s,Object(h.solove)(a.count,m,"*"),"+")}else s=Object(h.solove)(s,Object(h.solove)(a.count,Object(h.solove)(d.promotion_price,d.purchase_price,"-"),"*"),"+")}i++,e+=Number(a.count)}})})}),{totalAmount:a,totalPrice:o,totalNumber:e,totalKinds:i,totalCommission:s}},selectTotal:function(){var t=0,o=0;return this.quotation.length>0&&this.quotation.map(function(e){e.goodsInfo.map(function(e){e.kinds.map(function(e){e.checked&&(o++,t+=Number(e.count))})})}),{totalNumber:t,totalKinds:o}}},mixins:[h.mixins],created:function(){this.judgeFirstEnter()},mounted:function(){this.isFromGoodsDetail||(this.name=sessionStorage.quotationName?sessionStorage.quotationName:""),this.quotation=JSON.parse(sessionStorage.quotation);for(var t=sessionStorage.addQuotation?JSON.parse(sessionStorage.addQuotation):[],o=0;o<t.length;o++){var e=this.checkResult(t[o],this.quotation,"seller_id");if(-1===e)this.quotation.push(t[o]);else for(var i=0;i<t[o].goodsInfo.length;i++){var a=this.checkResult(t[o].goodsInfo[i],this.quotation[e].goodsInfo,"goods_id");if(-1===a)this.quotation[e].goodsInfo.push(t[o].goodsInfo[i]);else for(var n=0;n<t[o].goodsInfo[i].kinds.length;n++)this.quotation[e].goodsInfo[a].kinds.push(t[o].goodsInfo[i].kinds[n])}}sessionStorage.quotation=s()(this.quotation),sessionStorage.addQuotation="",this.quotation.map(function(t){t.checked=!1,t.goodsInfo.map(function(t){t.checked=!1,t.kinds.map(function(t){t.checked=!1})})})},methods:{judgeFirstEnter:function(){var t=this;this.$http("cart/firstLogin").then(function(o){o.code===t.$ok&&(t.isFirstEnter=!o.data)})},showNextGuidePage:function(){this.firstGuidePage=!1,this.twoGuidePage=!0},closeGuidePopup:function(){this.isFirstEnter=!1,this.firstGuidePage=!0,this.twoGuidePage=!1},showSharePopup:function(){this.isShowSharePopup=!0},hideSharePopup:function(){this.isShowSharePopup=!1,this.$router.push({name:"MakeQuotation"})},shareQuotation:function(){this.nickName?this.person=this.nickName:this.person=this.mobile;var t=Object(u.d)(),o={type:4,url:"/pages/quotationDetail/main?id="+this.id+"&buyer_id="+this.buyer_id,title:'这是"'+this.person+'"采购师为您制定的专属报价单，点此购买省更多！！！',discriable:"这是您的专属报价单，点此购买省更多！！！",imgUrl:Object(l.s)(this.quotation[0].goodsInfo[0].goods_img,200,200),from:2,shopCartId:this.id};try{if("Android"===t)return void window.android.share(s()(o));"iOS"===t&&window.webkit.messageHandlers.share.postMessage(s()(o))}catch(t){}this.isFromGoodsDetail?this.save(!0):(this.hideSharePopup(),this.$push({name:"QuotationList"}))},checkResult:function(t,o,e){if(0===o.length)return-1;for(var i=0;i<o.length;i++)if(t[e]===o[i][e])return i;return-1},isEnough:function(){for(var t=0;t<this.quotation.length;t++)for(var o=0;o<this.quotation[t].goodsInfo.length;o++)for(var e=0;e<this.quotation[t].goodsInfo[o].kinds.length;e++){if(1!==this.quotation[t].goodsInfo[o].goods_type)if(Object(h.totalNum)(this.quotation[t].goodsInfo[o].kinds,!1)<this.quotation[t].goodsInfo[o].buy_number)return this.$t("["+this.quotation[t].goodsInfo[o].goods_name+"]起批量至少为："+this.quotation[t].goodsInfo[o].buy_number+"件","bottom"),!0}return!1},save:function(t){var o=this;if(this.limitMoreClick)if(""!==this.name.trim())if(0!==this.quotation.length){if(!this.isEnough()){var e=[];this.quotation.map(function(t){t.goodsInfo.map(function(o){o.kinds.map(function(i){e.push({goods_num:i.count,seller_id:t.seller_id,goods_id:o.goods_id,spec_key:i.spec_key})})})});var i={offer_name:this.name,goodsInfo:s()(e),id:"",sameQuotat:""};this.limitMoreClick=!1,this.$http("cart/offerEdit",i).then(function(e){if(200===e.code){if(o.limitMoreClick=!1,o.id=e.data.id,o.buyer_id=e.data.buyer_id,sessionStorage.quotation="",o.$t("保存成功"),o.isFromGoodsDetail&&!t)return void o.$back();o.isFromGoodsDetail||o.$push("/quotation-list")}else o.$t(e.message)})}}else this.$t("报价单无商品");else this.$t("请输入报价单名称")},share:function(){var t=this;if(!this.isEnough())if(""!==this.name.trim())if(0!==this.quotation.length){var o=[];this.quotation.map(function(t){t.goodsInfo.map(function(e){e.kinds.map(function(i){o.push({goods_num:i.count,seller_id:t.seller_id,goods_id:e.goods_id,spec_key:i.spec_key})})})});var e={offer_name:this.name,goodsInfo:s()(o),id:"",sameQuotat:""};this.$http("cart/offerEdit",e).then(function(o){200===o.code&&(t.id=o.data.id,t.buyer_id=o.data.buyer_id,t.mobile=o.data.buyer_mobile,t.nickName=o.data.buyer_nickname,sessionStorage.quotation="")}),this.showSharePopup()}else this.$t("报价单无商品");else this.$t("请输入报价单名称")},addQuotation:function(){sessionStorage.quotation=s()(this.quotation),this.$router.push({path:"/add-quotation"})},toggleDel:function(){this.hasSelect=!0},formatPrice:function(t){return Object(h.formatPrice)(t)},add:function(t){this.hasSelect||t.count++},valid:function(t,o){/^[1-9][0-9]*$/.test(t.count)&&t.count?1===o.goods_type&&t.count>o.buy_number&&(t.count=o.buy_number):t.count=1},reduce:function(t){if(!this.hasSelect){if(1===t.count)return;t.count--}},finish:function(){this.hasSelect=!1},del:function(t,o,e,i){this.checkQuotationList(o,e,i)},checkQuotationList:function(t,o,e){var i=this.quotation[e].goodsInfo[o].kinds.length,s=this.quotation[e].goodsInfo.length;i<=1?s<=1?this.quotation.splice(e,1):this.quotation[e].goodsInfo.splice(o,1):this.quotation[e].goodsInfo[o].kinds.splice(t,1)},formatCommission:function(t){return Object(h.formatCommission)(t)},goBack:function(){Object(u.k)("nativeGoHomeNormalTab",0)}},beforeRouteEnter:function(t,o,e){e(function(t){"/quotation"===o.path&&(t.name="")})},beforeRouteLeave:function(t,o,e){sessionStorage.quotationName=this.name,sessionStorage.quotation=s()(this.quotation),e()},filters:{retainTwoDecimal:l.p},components:{delItem:a.default,checkAll:n.default,makeQuotationItem:c.default,Scroll:r.a}}),m={render:function(){var t=this,o=t.$createElement,i=t._self._c||o;return i("div",{staticClass:"make-quotation iphone-x-container"},[i("header",{ref:"header"},[i("div",{staticClass:"arrow-left",on:{click:function(o){t.showConfirm=!0}}},[i("img",{attrs:{src:e("DaLP"),alt:""}})]),t._v(" "),i("div",{staticClass:"title"},[t._v("\n      新建报价单\n    ")]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.isFromGoodsDetail,expression:"!isFromGoodsDetail"}],staticClass:"build"},[i("span",{staticClass:"add-icon"}),t._v(" "),i("span",{on:{click:t.goBack}},[t._v("添加商品")])])]),t._v(" "),i("div",{staticClass:"quotation-title"},[i("span",[t._v("名称")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"}],attrs:{type:"text",placeholder:"请输入报价单名称 最多12个字",maxlength:"12"},domProps:{value:t.name},on:{input:function(o){o.target.composing||(t.name=o.target.value)}}})]),t._v(" "),i("scroll",{directives:[{name:"show",rawName:"v-show",value:t.quotationLength,expression:"quotationLength"}],staticClass:"make-quotation-scroll"},[i("div",{staticClass:"list",class:t.hasSelect?"list-del":""},t._l(t.quotation,function(o,e){return i("make-quotation-item",{key:e,attrs:{item:o,"quotation-index":e,hasSelect:t.hasSelect},on:{selectShop:t.selectShop,selectGood:t.selectGood,selectKind:t.selectKind,add:t.add,reduce:t.reduce,valid:t.valid,deleteQuotationItem:t.del}})}))]),t._v(" "),i("footer",{directives:[{name:"show",rawName:"v-show",value:t.quotationLength,expression:"quotationLength"}]},[i("div",{staticClass:"btn-save",on:{click:function(o){t.save(!1)}}},[t._m(0)]),t._v(" "),i("div",{staticClass:"btn-area",on:{click:t.share}},[t._m(1)])]),t._v(" "),i("transition",{attrs:{name:"slide"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowSharePopup,expression:"isShowSharePopup"}],staticClass:"share-popup",on:{click:function(o){return o.target!==o.currentTarget?null:t.hideSharePopup(o)}}},[i("div",{staticClass:"share-popup-wrapper"},[i("h1",{staticClass:"share-title"},[t._v("分享报价单")]),t._v(" "),i("span",{staticClass:"share-close",on:{click:t.hideSharePopup}}),t._v(" "),i("div",{staticClass:"share-body"},[i("p",[t._v("您只需要将此报价单分享出去，不用囤货，不用发货，无额外费用，产生成交就有佣金拿，多劳多得，上不封顶哦！")]),t._v(" "),i("h5",[i("span",{staticClass:"share-title-text"},[t._v("分享可赚取佣金：")]),t._v(" "),i("span",{staticClass:"share-title-comission"},[t._v("￥"+t._s(t._f("retainTwoDecimal")(t.total.totalCommission)))])]),t._v(" "),i("h2",[i("img",{attrs:{src:e("Cqmg"),alt:""}}),t._v(" "),i("span",{staticClass:"share-text"},[t._v(t._s(t.name))])]),t._v(" "),i("div",{staticClass:"item"},[i("span",{staticClass:"item-dot"}),t._v(" "),i("span",{staticClass:"item-text"},[t._v("店铺数：")]),t._v(" "),i("span",{staticClass:"item-number"},[t._v(t._s(t.quotation.length))])]),t._v(" "),i("div",{staticClass:"item"},[i("span",{staticClass:"item-dot"}),t._v(" "),i("span",{staticClass:"item-text"},[t._v("商品数：")]),t._v(" "),i("span",{staticClass:"item-number"},[t._v(t._s(t.total.totalAmount))])]),t._v(" "),i("div",{staticClass:"item"},[i("span",{staticClass:"item-dot"}),t._v(" "),i("span",{staticClass:"item-text"},[t._v("家装业主购买价：")]),t._v(" "),i("span",{staticClass:"item-number"},[t._v("￥"+t._s(t._f("retainTwoDecimal")(t.total.totalPrice)))])])]),t._v(" "),i("div",{staticClass:"share-icon",on:{click:t.shareQuotation}},[i("img",{attrs:{src:e("McnM"),alt:""}}),t._v(" "),i("p",[t._v("微信好友")])])])])]),t._v(" "),i("transition",{attrs:{name:"fade"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.showConfirm,expression:"showConfirm"}],staticClass:"mask1"},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.showConfirm,expression:"showConfirm"}],staticClass:"module1"},[i("div",{staticClass:"title1"},[t._v("是否放弃本次报价单编辑")]),t._v(" "),i("div",{staticClass:"btn"},[i("span",{on:{click:function(o){t.$router.go(-1)}}},[t._v("确定")]),t._v(" "),i("span",{on:{click:function(o){t.showConfirm=!1}}},[t._v("取消")])])])])]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.isFirstEnter,expression:"isFirstEnter"}],staticClass:"quotation-guide1"},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.firstGuidePage,expression:"firstGuidePage"}],staticClass:"guide-bg1",on:{click:t.showNextGuidePage}}),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.twoGuidePage,expression:"twoGuidePage"}],staticClass:"guide-bg2",on:{click:t.closeGuidePopup}})]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.quotationLength,expression:"!quotationLength"}],staticClass:"quotation-no-quotation"},[i("img",{attrs:{src:e("1Cmb"),alt:""}}),t._v(" "),i("p",[t._v("报价单内没有商品哦，快去添加商品吧！")]),t._v(" "),i("div",{staticClass:"add-quotation",on:{click:t.addQuotation}},[i("span",{staticClass:"add-icon"}),t._v(" "),i("span",{staticClass:"add-text"},[t._v("添加商品")])])])],1)},staticRenderFns:[function(){var t=this.$createElement,o=this._self._c||t;return o("div",{staticClass:"make"},[o("img",{attrs:{src:e("JjoA"),alt:""}}),this._v(" "),o("span",[this._v("保存报价单")])])},function(){var t=this.$createElement,o=this._self._c||t;return o("div",{staticClass:"make"},[o("img",{attrs:{src:e("XhL9"),alt:""}}),this._v(" "),o("span",[this._v("分享报价单")])])}]};var v=e("VU/8")(d,m,!1,function(t){e("oC2W")},"data-v-211b59e8",null);o.default=v.exports}});